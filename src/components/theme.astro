---
import { Icon } from 'astro-icon/components'
---

<div class='relative ml-3' x-data='{ themeOpen: false }'>
  <div>
    <div
      class='inline-flex cursor-pointer items-center'
      id='menu-button'
      aria-haspopup='true'
      x-on:click='themeOpen = !themeOpen'
    >
      <Icon 
        class='h-5 w-5' 
        name='heroicons:sun' 
        aria-hidden='true' 
        x-bind:class="localStorage.theme === 'dark' ? 'text-white' : 'text-black'" 
      />
      <span class='mx-1'>/</span>
      <Icon 
        class='h-5 w-5' 
        name='heroicons:moon-solid' 
        aria-hidden='true' 
        x-bind:class="localStorage.theme === 'dark' ? 'text-white' : 'text-black'" 
      />
      <Icon 
        class='-mr-1 ml-2 h-5 w-5' 
        name='heroicons:chevron-down-20-solid' 
        aria-hidden='true' 
        x-bind:class="localStorage.theme === 'dark' ? 'text-white' : 'text-black'" 
      />
    </div>
  </div>

  <ul
    x-show='themeOpen'
    x-cloak
    x-transition:enter='transition ease-out duration-100'
    x-transition:enter-start='transform opacity-0 scale-95'
    x-transition:enter-end='transform opacity-100 scale-100'
    x-transition:leave='transition ease-in duration-75'
    x-transition:leave-start='transform opacity-100 scale-100'
    x-transition:leave-end='transform opacity-0 scale-95'
    class='absolute z-20 mt-1 max-h-56 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-gray-500 focus:outline-none sm:text-sm'
    tabindex='-1'
    role='listbox'
    aria-labelledby='listbox-label'
    aria-activedescendant='listbox-option-3'
  >
    <!-- System Option -->
    <li
      class='relative cursor-default select-none py-2 pl-2 pr-4 text-gray-700 hover:bg-gray-100 hover:text-gray-900 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-500 dark:hover:text-white'
      id='listbox-option-system'
      role='option'
      x-on:click="localStorage.removeItem('theme'); window.location.reload()"
    >
      <div class='flex items-center'>
        <Icon 
          class='h-6 w-6' 
          name='heroicons:star' 
          x-bind:class="localStorage.theme === 'dark' ? 'text-white' : 'text-black'"
        />
        <span class='ml-1 block truncate' x-bind:class="localStorage.theme ? 'font-normal' : 'font-semibold'">System</span>
      </div>
      <span
        x-show='!localStorage.theme'
        class='absolute inset-y-0 right-0 flex items-center pr-4'
        x-bind:class="localStorage.theme === 'dark' ? 'text-white' : 'text-gray-900'"
      >
        <Icon class='h-5 w-5' name='heroicons:check-20-solid' />
      </span>
    </li>

    <!-- Light Option -->
    <li
      class='relative cursor-default select-none py-2 pl-2 pr-4 text-gray-700 hover:bg-gray-100 hover:text-gray-900 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-500 dark:hover:text-white'
      id='listbox-option-light'
      role='option'
      x-on:click="localStorage.theme = 'light'; window.location.reload()"
    >
      <div class='flex items-center'>
        <Icon 
          class='h-6 w-6' 
          name='heroicons:sun' 
          x-bind:class="localStorage.theme === 'dark' ? 'text-white' : 'text-black'" 
        />
        <span class='ml-1 block truncate' x-bind:class="localStorage.theme == 'light' ? 'font-semibold' : 'font-normal'">Light</span>
      </div>
      <span
        x-show="localStorage.theme == 'light'"
        class='absolute inset-y-0 right-0 flex items-center pr-4'
        x-bind:class="localStorage.theme === 'dark' ? 'text-white' : 'text-gray-900'"
      >
        <Icon class='h-5 w-5' name='heroicons:check-20-solid' />
      </span>
    </li>

    <!-- Dark Option -->
    <li
      class='relative cursor-default select-none py-2 pl-2 pr-4 text-white-700 hover:bg-gray-100 hover:text-white-900 dark:bg-white dark:text-white-300 dark:hover:bg-white-500 dark:hover:text-white'
      id='listbox-option-dark'
      role='option'
      x-on:click="localStorage.theme = 'dark'; window.location.reload()"
    >
      <div class='flex items-center'>
        <Icon 
          class='h-6 w-6' 
          name='heroicons:moon-solid' 
          x-bind:class="localStorage.theme === 'dark' ? 'text-white' : 'text-black'"
        />
        <span class='ml-1 block truncate' x-bind:class="localStorage.theme == 'dark' ? 'font-semibold' : 'font-normal'">Dark</span>
      </div>
      <span
        x-show="localStorage.theme == 'dark'"
        class='absolute inset-y-0 right-0 flex items-center pr-4'
        x-bind:class="localStorage.theme === 'dark' ? 'text-white' : 'text-gray-900'"
      >
        <Icon class='h-5 w-5' name='heroicons:check-20-solid' />
      </span>
    </li>
  </ul>
</div>
